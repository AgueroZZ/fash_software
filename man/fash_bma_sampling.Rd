% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_sampling.R
\name{fash_bma_sampling}
\alias{fash_bma_sampling}
\title{Perform Bayesian Model Averaging (BMA) Sampling}
\usage{
fash_bma_sampling(
  data_i,
  posterior_weights,
  psd_values,
  refined_x,
  M,
  Si = NULL,
  Omegai = NULL,
  num_basis = 30,
  betaprec = 1e-06,
  order = 2,
  pred_step = 1,
  likelihood,
  deriv = 0
)
}
\arguments{
\item{data_i}{A single dataset extracted from the \code{data_list} component of \code{fash_set_data}. Must be a list containing \code{y}, \code{x}, and \code{offset}.}

\item{posterior_weights}{A numeric vector representing the posterior weights of the PSD values for the i-th dataset.}

\item{psd_values}{A numeric vector of PSD values corresponding to the posterior weights.}

\item{refined_x}{A numeric vector of grid points where posterior sample paths are evaluated.}

\item{M}{An integer specifying the total number of posterior samples to generate.}

\item{Si}{A numeric vector representing the standard errors for the dataset (if applicable).}

\item{Omegai}{A numeric precision matrix for the dataset (if applicable).}

\item{num_basis}{An integer specifying the number of O-Spline basis functions.}

\item{betaprec}{A numeric value representing the precision of the fixed effects coefficients.}

\item{order}{An integer specifying the order of the Integrated Wiener Process (IWP) prior.}

\item{pred_step}{A numeric value specifying the prediction step size.}

\item{likelihood}{A character string specifying the likelihood function to use. Options are `gaussian` and `poisson`.}

\item{deriv}{An integer specifying the order of the derivative to compute.}
}
\value{
A list containing:
  \describe{
    \item{\code{posterior_samples}}{A numeric matrix of posterior sample paths, where rows correspond to grid points in \code{refined_x} and columns correspond to the M generated samples.}
    \item{\code{sampled_counts}}{A table of sampled PSD values and their corresponding frequencies.}
  }
}
\description{
This function performs Bayesian Model Averaging (BMA) for the i-th dataset by:
1. Sampling PSD values based on posterior weights.
2. Using the sampled PSD values to generate posterior samples.
}
\examples{
# Example usage
set.seed(1)
Y <- matrix(rpois(20, lambda = 5), nrow = 4, ncol = 5)
smooth_var <- matrix(runif(20), nrow = 4, ncol = 5)
offset <- 1
fash_data <- fash_set_data(Y, smooth_var, offset)
posterior_weights <- c(0.1, 0.4, 0.3, 0.2)
psd_values <- c(0.1, 0.5, 1.0, 2.0)
refined_x <- seq(0, 10, length.out = 50)
results <- fash_bma_sampling(
  data_i = fash_data$data_list[[1]],
  posterior_weights = posterior_weights,
  psd_values = psd_values,
  refined_x = refined_x,
  M = 100,
  likelihood = "poisson"
)
print(results$posterior_samples)
print(results$sampled_counts)


}
\keyword{internal}
