% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/04_fashr.R
\name{predict.fashr}
\alias{predict.fashr}
\title{Predict Method for FASHR Objects}
\usage{
\method{predict}{fashr}(
  object,
  index = 1,
  smooth_var = NULL,
  only.samples = FALSE,
  M = 3000,
  ...
)
}
\arguments{
\item{object}{A `fashr` object containing the results of the FASH pipeline.}

\item{index}{An integer specifying the dataset index to predict. Default is `1`.}

\item{smooth_var}{A numeric vector specifying refined x values for prediction. If `NULL`, uses the x values from the model fit. Default is `NULL`.}

\item{only.samples}{A logical value. If `TRUE`, returns posterior samples. If `FALSE`, summarizes the samples into mean and 95 percent confidence intervals. Default is `FALSE`.}

\item{M}{An integer specifying the number of posterior samples to generate. Default is `3000`.}

\item{...}{Additional arguments (not used).}
}
\value{
If `only.samples = TRUE`, a matrix of posterior samples where rows correspond to `smooth_var` and columns correspond to posterior draws.
If `only.samples = FALSE`, a data frame summarizing posterior predictions with columns:

  - `x`: The refined x values.

  - `mean`: The posterior mean.

  - `lower`: The lower bound of the 95 percent interval.

  - `upper`: The upper bound of the 95 percent interval.

  - `median`: The posterior median.
}
\description{
Generates posterior predictions for a specific dataset from a `fashr` object using Bayesian Model Averaging.
}
\examples{
# Example 1: Predict for a specific dataset with summarized results
data_list <- list(
  data.frame(y = rpois(5, lambda = 5), x = 1:5, offset = 0),
  data.frame(y = rpois(5, lambda = 5), x = 1:5, offset = 0)
)
S <- list(rep(0.5, 5), rep(0.8, 5))
Omega <- list(diag(5), diag(5))
grid <- seq(0, 2, length.out = 10)
fashr_obj <- fashr(data_list = data_list, Y = "y", smooth_var = "x", offset = "offset", S = S, Omega = Omega, grid = grid, likelihood = "poisson", verbose = TRUE)
predict(fashr_obj, index = 1, smooth_var = seq(1, 5, length.out = 50), only.samples = FALSE)

# Example 2: Generate posterior samples
samples <- predict(fashr_obj, index = 1, smooth_var = seq(1, 5, length.out = 50), only.samples = TRUE)
dim(samples)  # Rows: refined_x, Columns: posterior samples

# Example 3: Use original x values for prediction
summary <- predict(fashr_obj, index = 1, smooth_var = NULL, only.samples = FALSE)
head(summary)

# Example 4: Increase number of posterior samples
samples <- predict(fashr_obj, index = 1, smooth_var = seq(1, 5, length.out = 50), only.samples = TRUE, M = 5000)
summary <- predict(fashr_obj, index = 1, smooth_var = seq(1, 5, length.out = 50), only.samples = FALSE, M = 5000)

}
