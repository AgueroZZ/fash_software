% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/05_lfsr.R
\name{compute_lfsr_summary}
\alias{compute_lfsr_summary}
\title{Compute Local False Sign Rate (LFSR) from Marginal Posterior Mean and Variance}
\usage{
compute_lfsr_summary(object, index = 1, smooth_var = NULL, deriv = 0)
}
\arguments{
\item{object}{A \code{fash} object containing the fitted results.}

\item{index}{An integer specifying the dataset index.}

\item{smooth_var}{A numeric vector specifying refined x values for evaluation.
If \code{NULL}, defaults to the dataset's original x values.}

\item{deriv}{An integer specifying the order of the derivative to compute.}
}
\value{
A data frame with the following columns:

\describe{
  \item{x}{The refined x values where posterior probabilities are evaluated.}
  \item{pos_prob}{The posterior probability that the function is positive at each x.}
  \item{neg_prob}{The posterior probability that the function is negative at each x.}
  \item{lfsr}{The local false sign rate (LFSR) at each x, computed as \code{pmin(pos_prob, neg_prob)}.}
}
}
\description{
This function computes the local false sign rate (LFSR) at each evaluation point
for a specific dataset in a \code{fash} object using the posterior mean and variance
instead of sampling-based methods.
}
\examples{
# Example usage
data_list <- list(
  data.frame(y = rpois(5, lambda = 5), x = 1:5, offset = 0),
  data.frame(y = rpois(5, lambda = 5), x = 1:5, offset = 0)
)
grid <- seq(0, 2, length.out = 10)
fash_obj <- fash(data_list = data_list, Y = "y", smooth_var = "x", grid = grid, likelihood = "poisson", verbose = TRUE)

# Compute LFSR summary for dataset 1
lfsr_summary_df <- compute_lfsr_summary(fash_obj, index = 1)
print(lfsr_summary_df)

}
