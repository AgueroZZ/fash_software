% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/02_empirical_bayes.R
\name{fash_eb_est}
\alias{fash_eb_est}
\title{Perform Empirical Bayes (EB) on Inferred Likelihood Matrix}
\usage{
fash_eb_est(L_matrix, penalty = 1, grid)
}
\arguments{
\item{L_matrix}{A numeric matrix representing the log-likelihood values. Rows correspond to datasets, and columns correspond to grid points.}

\item{penalty}{A numeric value representing the lambda value for the Dirichlet prior.}

\item{grid}{A numeric vector representing the grid of PSD (Predictive Standard Deviation) values.}
}
\value{
A list containing:
  \describe{
    \item{\code{prior_weight}}{A data frame with two columns: \code{psd} (non-trivial PSD values) and \code{prior_weight} (learned prior weights).}
    \item{\code{posterior_weight}}{A numeric matrix where rows correspond to datasets, and columns correspond to non-trivial PSD values, representing the posterior weights.}
  }
}
\description{
This function performs empirical Bayes estimation on the provided (log) likelihood matrix, incorporating an optional Dirichlet prior penalty.
}
\examples{
# Example usage
set.seed(1)
L_matrix <- matrix(rnorm(500), nrow = 100, ncol = 5)
grid <- seq(0, 2, length.out = 5)
result <- fash_eb_est(L_matrix, penalty = 2, grid = grid)
print(result$prior_weight)
print(result$posterior_weight)

}
